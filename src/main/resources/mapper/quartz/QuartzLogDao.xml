<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.modules.quartz.dao.QuartzLogDao">

    <!-- 字段集 -->
    <sql id="quartzLogBaseSqlLocal">
        select log_id, job_name, invoke_target, message, status, create_time from quartz_log
    </sql>

    <!-- 查询列表字段 -->
    <select id="queryList" resultType="com.platform.modules.quartz.domain.QuartzLog">
        <include refid="quartzLogBaseSqlLocal"/>
        <where>
            <!--
            <if test="logId != null and logId != ''">
                and log_id = #{logId}
            </if>
            -->
            <!--
            <if test="jobName != null and jobName != ''">
                and job_name = #{jobName}
            </if>
            -->
            <!--
            <if test="invokeTarget != null and invokeTarget != ''">
                and invoke_target = #{invokeTarget}
            </if>
            -->
            <!--
            <if test="message != null and message != ''">
                and message = #{message}
            </if>
            -->
            <!--
            <if test="status != null and status != ''">
                and status = #{status}
            </if>
            -->
            <!--
            <if test="createTime != null and createTime != ''">
                and create_time = #{createTime}
            </if>
            -->
        </where>
    </select>
    <!-- 新增查询：删除几天以前的-->
    <!-- 删除 chat_user_sign 表中符合条件的数据（建议移到对应 DAO 的 Mapper 中） -->
    <delete id="dellogs">
        delete from quartz_log
        ${ew.customSqlSegment}  <!-- 依赖 QueryWrapper 传入条件（如“三天前的数据”） -->
    </delete>
</mapper>
